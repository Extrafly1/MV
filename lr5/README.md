## Алгоритмы цифровой обработки мультимедиа

### Реализация спектрального шумоподавления с использованием собственных алгоритмов DFT, FFT и IFFT

---

## Цель работы

Изучить преобразование Фурье и реализовать алгоритм шумоподавления в аудиосигнале с применением:

* **ручного DFT (дискретного преобразования Фурье)**
* **ручного IFFT (обратного дискретного преобразования Фурье)**
* **ручной реализации FFT (быстрого преобразования Фурье)**
* алгоритма **спектрального вычитания шума**

Работа выполняется на языке Python с использованием библиотек `soundfile` и `numpy`. Алгоритмы Фурье реализованы  **полностью вручную** , без использования `numpy.fft`.

---

# 1. Теоретические сведения

## 1.1. Дискретное преобразование Фурье (DFT)

DFT преобразует временной сигнал в частотный спектр. Формула прямого преобразования:

$$
X[k] = \sum_{n=0}^{N-1} x[n] \cdot e^{-j 2\pi kn / N}
$$

Обратное преобразование:

$$
x[n] = \frac{1}{N} \sum_{k=0}^{N-1} X[k] \cdot e^{j 2\pi kn / N}
$$

Особенности:

* простая формула
* высокая вычислительная сложность: **O(N²)**
* подходит для обучения и проверки

## 1.2. Быстрое преобразование Фурье (FFT)

FFT — оптимизированный вариант DFT, использующий рекурсивное разбиение сигнала на чётные и нечётные элементы:

$$
X[k] = E[k] + W_N^k O[k]
$$

$$
X[k+N/2] = E[k] - W_N^k O[k]
$$

Где:

$$
W_N^k = e^{-j 2\pi k / N}
$$

Особенности FFT:

* сложность: **O(N log N)**
* применяется к сигналам длиной степени двойки
* реализуется рекурсивным алгоритмом Cooley–Tukey

## 1.3. Обратное быстрое преобразование Фурье (IFFT)

IFFT аналогично FFT, но использует положительный показатель экспоненты и финальное деление на 2 при каждом уровне рекурсии.

---

# 2. Реализованные алгоритмы

В рамках работы были разработаны следующие алгоритмы:

---

## 2.1. Собственная реализация DFT

Создана функция:

* принимает сигнал длины N
* для каждого частотного бинана вычисляет сумму по формуле
* возвращает полный комплексный спектр

Плюсы: простота, наглядность

Минусы: медленно при больших N

---

## 2.2. Собственная реализация IDFT

Реализовано обратное преобразование для восстановления временного сигнала:

* повторяет структуру DFT
* использует экспоненту с обратным знаком
* делит результат на N

---

## 2.3. Реализация быстрого Фурье (FFT)

Написана чистая рекурсивная реализация алгоритма Cooley–Tukey:

* проверка длины на степень двойки
* разбиение массива на `even` и `odd`
* рекурсивное применение FFT
* вычисление "бабочек" (butterflies)
* объединение спектров

Преимущества:

* многократный выигрыш в скорости
* позволяет работать с длинными файлами

---

## 2.4. Реализация обратного FFT (IFFT)

Алгоритм полностью повторяет FFT, но:

* использует положительный показатель экспоненты
* делит результаты на 2 на каждом рекурсивном уровне
* в конце приводит значения к вещественным

---

## 2.5. Алгоритм подавления шума на основе FFT

Используемая методика —  **спектральное вычитание шума** :

1. Выполняется FFT сигнала.
2. Амплитудный спектр анализируется для нахождения уровня шума.
3. Определяется порог шума как низкий перцентиль спектра.
4. Амплитуды ниже порога обнуляются.
5. Амплитуды выше порога уменьшаются на величину шума.
6. Сохраняется исходная фаза.
7. Выполняется IFFT.
8. Сигнал нормализуется.

---

# 3. Используемые библиотеки

* Python 3.x
* `soundfile` — чтение/запись WAV
* `numpy` — массивы
* `cmath`, `math` — комплексные числа

---

# 4. Структура решения

Основные части программы:

1. `fft()` — реализация прямого FFT
2. `ifft()` — реализация обратного FFT
3. `next_pow2()` — дополнение сигнала нулями
4. `noise_reduction_fft()` — алгоритм спектрального подавления шума
5. Основной блок с загрузкой/сохранением WAV

Полный код был предоставлен ранее.

---

# 5. Вывод

В ходе лабораторной работы:

* Реализованы алгоритмы DFT, FFT и IFFT без использования библиотек.
* Реализован и протестирован алгоритм спектрального подавления шума.
* Продемонстрировано, что FFT значительно ускоряет обработку по сравнению с DFT.
* Получен рабочий инструмент для очистки аудиосигналов.

---

# 6. Вопросы

### **1. Что такое шум на аудиодорожке?**

Шум — это нежелательный случайный или паразитный сигнал, добавляющийся к полезному звуку.

Он может быть вызван:

* микрофонными помехами
* электрическими наводками
* цифровыми искажениями
* фоновыми звуками окружения

---

### **2. Что такое дискретный спектр, амплитуда и фаза?**

* **Дискретный спектр** — набор частотных компонент, полученных после преобразования Фурье.
* **Амплитуда спектра** — «сила» каждой частоты.
* **Фаза** — относительный сдвиг синусоиды данной частоты во времени.

---

### **3. Какие разновидности БПФ существуют?**

Основные виды FFT:

* Radix-2 FFT
* Radix-4 FFT
* Mixed Radix FFT
* Split-Radix FFT
* RFFT (для реальных сигналов)
* Многомерные FFT (2D, 3D)

---

### **4. Какие аппроксимирующие функции применяются для алгоритма подавления шума?**

Используются  **оконные функции** , позволяющие уменьшить спектральные утечки:

* окно Хэмминга
* окно Ханна
* окно Блэкмана
* треугольное (Барлетта)
* прямоугольное

Они позволяют сгладить разрыв сигнала при разбиении на фрагменты.
