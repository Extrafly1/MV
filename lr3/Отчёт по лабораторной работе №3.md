## "Методы фильтрации и размытия изображения. Фильтр Гаусса"

### Цель работы
Изучение и практическая реализация методов фильтрации и размытия изображений с использованием фильтра Гаусса, сравнение собственной реализации с функционалом библиотеки OpenCV.

### Теоретическая часть
**Фильтр Гаусса** - один из базовых алгоритмов обработки изображений, используемый для подавления шумов и сглаживания. Он основан на применении ядра свертки, значения которого рассчитываются по функции Гаусса:

```
gauss[x,y] = (1/(2πσ²)) * e^(-(x²+y²)/(2σ²))
```

где:
- σ - стандартное отклонение (параметр размытия)
- x, y - координаты относительно центра ядра

### Ход работы

#### 1. Реализация функции создания ядра Гаусса
```python
def gaussian_kernel(size, sigma):
    kernel = np.zeros((size, size))
    center = size // 2
    for i in range(size):
        for j in range(size):
            x = i - center
            y = j - center
            kernel[i, j] = np.exp(-(x**2 + y**2) / (2 * sigma**2))
    return kernel / np.sum(kernel)
```

#### 2. Реализация функции применения фильтра Гаусса
```python
def custom_gaussian_blur(image, kernel):
    h, w = image.shape
    k_size = kernel.shape[0]
    pad = k_size // 2
    padded = cv2.copyMakeBorder(image, pad, pad, pad, pad, cv2.BORDER_REFLECT)
    result = np.zeros_like(image, dtype=np.float32)
    
    for i in range(h):
        for j in range(w):
            region = padded[i:i+k_size, j:j+k_size]
            result[i, j] = np.sum(region * kernel)
    return result.astype(np.uint8)
```

#### 3. Загрузка и подготовка изображения
```python
cap = cv2.VideoCapture(r'test_image.jpg', cv2.CAP_ANY)
ret, image = cap.read()
if not(ret):
    print("break")
gray = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)
```

#### 4. Построение матриц Гаусса различных размеров
Были построены матрицы Гаусса размером 3×3, 5×5 и 7×7 с параметром σ=1.0:

**Матрица Гаусса 3×3:**
```
[0.0751 0.1238 0.0751]
[0.1238 0.2042 0.1238]
[0.0751 0.1238 0.0751]
Сумма: 1.000000
```

**Матрица Гаусса 5×5:**
```
[0.0030 0.0133 0.0219 0.0133 0.0030]
[0.0133 0.0596 0.0983 0.0596 0.0133]
[0.0219 0.0983 0.1621 0.0983 0.0219]
[0.0133 0.0596 0.0983 0.0596 0.0133]
[0.0030 0.0133 0.0219 0.0133 0.0030]
Сумма: 1.000000
```

**Матрица Гаусса 7×7:**
```
[0.0005 0.0019 0.0042 0.0054 0.0042 0.0019 0.0005]
[0.0019 0.0084 0.0186 0.0241 0.0186 0.0084 0.0019]
[0.0042 0.0186 0.0412 0.0533 0.0412 0.0186 0.0042]
[0.0054 0.0241 0.0533 0.0691 0.0533 0.0241 0.0054]
[0.0042 0.0186 0.0412 0.0533 0.0412 0.0186 0.0042]
[0.0019 0.0084 0.0186 0.0241 0.0186 0.0084 0.0019]
[0.0005 0.0019 0.0042 0.0054 0.0042 0.0019 0.0005]
Сумма: 1.000000
```

#### 5. Применение фильтра с различными параметрами
Были применены следующие комбинации параметров:
- Размер ядра 3×3, σ=0.5
- Размер ядра 3×3, σ=2.0
- Размер ядра 5×5, σ=0.5
- Размер ядра 5×5, σ=2.0

Для каждой комбинации сохранено результирующее изображение.

#### 6. Сравнение с реализацией в OpenCV
```python
opencv_blur = cv2.GaussianBlur(gray, (5, 5), sigmaX=2.0)
custom_blur = custom_gaussian_blur(gray, gaussian_kernel(5, 2.0))
```

Было проведено визуальное сравнение результатов и вычислена среднеквадратичная ошибка (MSE) между реализациями.

### Результаты работы

1. **Успешно реализованы функции:**
   - Создания ядра Гаусса произвольного размера
   - Применения фильтра Гаусса к изображению

2. **Построены матрицы Гаусса** для размеров 3×3, 5×5 и 7×7

3. **Созданы размытые изображения** с различными параметрами фильтрации

4. **Проведено сравнение** собственной реализации с функцией `GaussianBlur` из OpenCV

5. **Создана мозаика** со всеми результатами для наглядного сравнения

### Выводы

1. Фильтр Гаусса эффективно устраняет шумы и сглаживает изображение, причем степень размытия напрямую зависит от параметра σ и размера ядра.

2. С увеличением размера ядра и параметра σ степень размытия возрастает, но при этом может теряться важная информация о границах объектов.

3. Собственная реализация фильтра Гаусса показала результаты, близкие к реализации в OpenCV, что подтверждает корректность алгоритма.

4. Оптимальные параметры фильтрации зависят от конкретной задачи: для сильного подавления шума требуются большие значения σ и размера ядра, для сохранения границ - меньшие.

5. Нормировка ядра свертки является важным этапом, обеспечивающим сохранение общей яркости изображения после фильтрации.

### Ответы на контрольные вопросы

1. **Принцип размытия изображения** заключается в замене значения каждого пикселя на взвешенную сумму значений окружающих пикселей, что позволяет снизить влияние шумов и сгладить резкие переходы.

2. **Операция свертки** - математическая операция применения ядра (маски) ко всем пикселям изображения, где новое значение пикселя вычисляется как сумма произведений значений пикселей области и соответствующих элементов ядра.

3. **Матрица свертки Гаусса** строится путем вычисления значений функции Гаусса для каждой позиции относительно центра ядра с последующей нормировкой.

4. **Алгоритм размытия по Гауссу** включает: построение ядра, нормировку, применение свертки ко всем внутренним пикселям изображения.

5. **Параметры размытия**: размер ядра (kernel size) и стандартное отклонение (σ).

6. **В OpenCV** фильтрация по Гауссу выполняется функцией `GaussianBlur()` с параметрами: исходное изображение, размер ядра, стандартное отклонение по X и Y.
